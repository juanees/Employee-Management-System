generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Employee {
  id         String   @id @default(uuid())
  dni        String   @unique
  firstName  String
  lastName   String
  email      String   @unique
  taxStatus  String   @default("unknown")
  status     String   @default("active")
  roles      String   @default("[]")
  hiredAt    DateTime @default(now())
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  vehicles   Vehicle[]
  travel     TravelRequest[]
}

model Vehicle {
  id                  String   @id @default(uuid())
  plateNumber         String   @unique
  model               String
  year                Int
  insuranceExpiresOn  DateTime
  vtvExpiresOn        DateTime
  status              String   @default("available")
  assignedEmployeeId  String?
  assignedEmployee    Employee? @relation(fields: [assignedEmployeeId], references: [id])
  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt
  travelRequests      TravelRequest[]
}

model TravelRequest {
  id               String   @id @default(uuid())
  employeeId       String
  vehicleId        String?
  origin           String
  destination      String
  startDate        DateTime
  endDate          DateTime
  purpose          String
  status           String   @default("pending_approval")
  approverComments String?
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
  employee         Employee @relation(fields: [employeeId], references: [id])
  vehicle          Vehicle? @relation(fields: [vehicleId], references: [id])
}

model Role {
  id          String   @id @default(uuid())
  name        String   @unique
  description String?
  permissions String   @default("[]")
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}
